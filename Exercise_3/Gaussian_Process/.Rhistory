return(mat_f)
}
n <-100
x <- runif(n,0,1)
b <- 0.01
tao_2_1 <- 0.3
tao_2_2 <- 1e-06
idx_x <- order(x)
mat_f<- get_f_samples(x,b,tao_2_1,tao_2_2,d_euclid
plot(1, type="n", xlab="", ylab="", xlim=c(0, 1), ylim=c(-5,5))
mat_f<- get_f_samples(x,b,tao_2_1,tao_2_2,d_euclid)
plot(1, type="n", xlab="", ylab="", xlim=c(0, 1), ylim=c(-5,5))
for(i in 1:n_samples){
lines(x[idx_x],mat_f[,i][idx_x])
}
plot(1, type="n", xlab="", ylab="", xlim=c(0, 1), ylim=c(-5,5))
for(i in 1:n_samples){
lines(x[idx_x],mat_f[,i][idx_x])
}
hig_b_low_t1 <- get_f_samples(x,b=10,0.001,tao_2_2,d_euclid)
plot(1, type="n", xlab="", ylab="", xlim=c(0, 1), ylim=c(-5,5))
for(i in 1:n_samples){
lines(x[idx_x],mat_f[,i][idx_x])
}
h_b_l_t1 <- get_f_samples(x,b=10,0.001,tao_2_2,d_euclid)
high_b_low_t1 <- get_f_samples(x,b=10,0.001,tao_2_2,d_euclid)
plot(1, type="n", xlab="", ylab="", xlim=c(0, 1), ylim=c(-5,5))
for(i in 1:n_samples){
lines(x[idx_x],high_b_low_t1[,i][idx_x])
}
high_b_low_t1 <- get_f_samples(x,b=1,0.01,tao_2_2,d_euclid)
plot(1, type="n", xlab="", ylab="", xlim=c(0, 1), ylim=c(-5,5))
for(i in 1:n_samples){
lines(x[idx_x],high_b_low_t1[,i][idx_x])
}
high_b_low_t1 <- get_f_samples(x,b=1,0.01,tao_2_2,d_euclid)
plot(1, type="n", xlab="", ylab="", xlim=c(0, 1), ylim=c(-5,5))
for(i in 1:n_samples){
lines(x[idx_x],high_b_low_t1[,i][idx_x])
}
low_b_low_t1 <- get_f_samples(x,b=0.01,0.01,tao_2_2,d_euclid)
plot(1, type="n", xlab="", ylab="", xlim=c(0, 1), ylim=c(-5,5))
for(i in 1:n_samples){
lines(x[idx_x],high_b_low_t1[,i][idx_x])
}
low_b_low_t1 <- get_f_samples(x,b=0.01,0.01,tao_2_2,d_euclid)
plot(1, type="n", xlab="", ylab="", xlim=c(0, 1), ylim=c(-5,5))
for(i in 1:n_samples){
lines(x[idx_x],low_b_low_t1[,i][idx_x])
}
high_b_low_t1 <- get_f_samples(x,b=1,0.1,tao_2_2,d_euclid)
plot(1, type="n", xlab="", ylab="", xlim=c(0, 1), ylim=c(-5,5))
for(i in 1:n_samples){
lines(x[idx_x],high_b_low_t1[,i][idx_x])
}
low_b_low_t1 <- get_f_samples(x,b=0.1,0.1,tao_2_2,d_euclid)
plot(1, type="n", xlab="", ylab="", xlim=c(0, 1), ylim=c(-5,5))
for(i in 1:n_samples){
lines(x[idx_x],low_b_low_t1[,i][idx_x])
}
low_b_low_t1 <- get_f_samples(x,b=0.01,0.1,tao_2_2,d_euclid)
plot(1, type="n", xlab="", ylab="", xlim=c(0, 1), ylim=c(-5,5))
for(i in 1:n_samples){
lines(x[idx_x],low_b_low_t1[,i][idx_x])
}
low_b_low_t1 <- get_f_samples(x,b=0.01,0.1,tao_2_2,d_euclid)
plot(1, type="n", xlab="", ylab="", xlim=c(0, 1), ylim=c(-5,5))
for(i in 1:n_samples){
lines(x[idx_x],low_b_low_t1[,i][idx_x],col=sample(rainbow(10)))
}
low_b_low_t1 <- get_f_samples(x,b=0.01,0.1,tao_2_2,d_euclid)
plot(1, type="n", xlab="", ylab="", xlim=c(0, 1), ylim=c(-5,5))
for(i in 1:n_samples){
lines(x[idx_x],low_b_low_t1[,i][idx_x],col=sample(rainbow(10)),lwd=2)
}
low_b_low_t1 <- get_f_samples(x,b=0.01,0.1,tao_2_2,d_euclid)
plot(1, type="n", xlab="", ylab="", xlim=c(0, 1), ylim=c(-5,5))
for(i in 1:n_samples){
lines(x[idx_x],low_b_low_t1[,i][idx_x],col=sample(rainbow(10)),lwd=1.5)
}
low_b_low_t1 <- get_f_samples(x,b=0.01,0.1,tao_2_2,d_euclid)
plot(1, type="n", xlab="", ylab="", xlim=c(0, 1), ylim=c(-5,5))
for(i in 1:n_samples){
lines(x[idx_x],low_b_low_t1[,i][idx_x],col=1:length(n_samples),lwd=1.5)
}
low_b_low_t1 <- get_f_samples(x,b=0.01,0.1,tao_2_2,d_euclid)
plot(1, type="n", xlab="", ylab="", xlim=c(0, 1), ylim=c(-5,5))
for(i in 1:n_samples){
lines(x[idx_x],low_b_low_t1[,i][idx_x],col=i,lwd=1.5)
}
low_b_low_t1 <- get_f_samples(x,b=0.01,0.1,tao_2_2,d_euclid)
plot(1, type="n", xlab="", ylab="", xlim=c(0, 1), ylim=c(-5,5))
for(i in 1:n_samples){
lines(x[idx_x],low_b_low_t1[,i][idx_x],col=i+5,lwd=1.5)
}
low_b_low_t1 <- get_f_samples(x,b=0.01,0.1,tao_2_2,d_euclid)
plot(1, type="n", xlab="", ylab="", xlim=c(0, 1), ylim=c(-5,5))
for(i in 1:n_samples){
lines(x[idx_x],low_b_low_t1[,i][idx_x],col=i+10,lwd=1.5)
}
low_b_low_t1 <- get_f_samples(x,b=0.01,0.1,tao_2_2,d_euclid)
plot(1, type="n", xlab="", ylab="", xlim=c(0, 1), ylim=c(-5,5))
for(i in 1:n_samples){
lines(x[idx_x],low_b_low_t1[,i][idx_x],col=i+20,lwd=1.5)
}
low_b_low_t1 <- get_f_samples(x,b=0.01,0.1,tao_2_2,d_euclid)
plot(1, type="n", xlab="", ylab="", xlim=c(0, 1), ylim=c(-5,5))
for(i in 1:n_samples){
lines(x[idx_x],low_b_low_t1[,i][idx_x],col=i,lwd=1.5)
}
high_b_low_t1 <- get_f_samples(x,b=1,0.1,tao_2_2,d_euclid)
plot(1, type="n", xlab="", ylab="", xlim=c(0, 1), ylim=c(-5,5))
for(i in 1:n_samples){
lines(x[idx_x],high_b_low_t1[,i][idx_x],col=i,lwd=1.5)
}
high_b_high_t1 <- get_f_samples(x,b=1,1,tao_2_2,d_euclid)
plot(1, type="n", xlab="", ylab="", xlim=c(0, 1), ylim=c(-5,5))
for(i in 1:n_samples){
lines(x[idx_x],high_b_low_t1[,i][idx_x],col=i,lwd=1.5)
}
high_b_high_t1 <- get_f_samples(x,b=1,3,tao_2_2,d_euclid)
plot(1, type="n", xlab="", ylab="", xlim=c(0, 1), ylim=c(-5,5))
for(i in 1:n_samples){
lines(x[idx_x],high_b_low_t1[,i][idx_x],col=i,lwd=1.5)
}
high_b_high_t1 <- get_f_samples(x,b=1,5,tao_2_2,d_euclid)
plot(1, type="n", xlab="", ylab="", xlim=c(0, 1), ylim=c(-5,5))
for(i in 1:n_samples){
lines(x[idx_x],high_b_low_t1[,i][idx_x],col=i,lwd=1.5)
}
high_b_high_t1 <- get_f_samples(x,b=1,1000,tao_2_2,d_euclid)
plot(1, type="n", xlab="", ylab="", xlim=c(0, 1), ylim=c(-5,5))
for(i in 1:n_samples){
lines(x[idx_x],high_b_low_t1[,i][idx_x],col=i,lwd=1.5)
}
high_b_high_t1 <- get_f_samples(x,b=1,2,tao_2_2,d_euclid)
plot(1, type="n", xlab="", ylab="", xlim=c(0, 1), ylim=c(-5,5))
for(i in 1:n_samples){
lines(x[idx_x],high_b_high_t1[,i][idx_x],col=i,lwd=1.5)
}
high_b_high_t1 <- get_f_samples(x,b=1,3,tao_2_2,d_euclid)
plot(1, type="n", xlab="", ylab="", xlim=c(0, 1), ylim=c(-5,5))
for(i in 1:n_samples){
lines(x[idx_x],high_b_high_t1[,i][idx_x],col=i,lwd=1.5)
}
high_b_high_t1 <- get_f_samples(x,b=1,2,tao_2_2,d_euclid)
plot(1, type="n", xlab="", ylab="", xlim=c(0, 1), ylim=c(-5,5))
for(i in 1:n_samples){
lines(x[idx_x],high_b_high_t1[,i][idx_x],col=i,lwd=1.5)
}
high_b_high_t1 <- get_f_samples(x,b=1,2,tao_2_2,d_euclid)
plot(1, type="n", xlab="", ylab="", xlim=c(0, 1), ylim=c(-5,5))
for(i in 1:n_samples){
lines(x[idx_x],high_b_high_t1[,i][idx_x],col=i,lwd=1.5,type="n")
}
high_b_high_t1 <- get_f_samples(x,b=1,2,tao_2_2,d_euclid)
plot(1, type="n", xlab="", ylab="", xlim=c(0, 1), ylim=c(-5,5))
for(i in 1:n_samples){
lines(x[idx_x],high_b_high_t1[,i][idx_x],col=i,lwd=1.5,type="l")
}
high_b_high_t1 <- get_f_samples(x,b=1,2,tao_2_2,d_euclid)
plot(1, type="n", xlab="", ylab="", xlim=c(0, 1), ylim=c(-5,5))
for(i in 1:n_samples){
lines(x[idx_x],high_b_high_t1[,i][idx_x],col=i,lwd=1.5,type="b")
}
high_b_high_t1 <- get_f_samples(x,b=1,2,tao_2_2,d_euclid)
plot(1, type="n", xlab="", ylab="", xlim=c(0, 1), ylim=c(-5,5))
for(i in 1:n_samples){
lines(x[idx_x],high_b_high_t1[,i][idx_x],col=i,lwd=1.5)
}
j_brew_colors <- brewer.pal(n = 8, name = "Dark2")
install.packages(dplyr)
install.packages("dplyr")
1
1
1+1
library(dplyr)
library(mvtnorm)
d_euclid <- function(x,x_p){
return(abs(x-x_p))
}
matern_cov <- function(tao_2_1,tao_2_2,b,d,x){
Sigma <- matrix(NA,length(x),length(x))
for(i in 1:length(x)){
for(j in 1:length(x)){
Sigma[i,j] <- tao_2_1*exp(-(1/2)*(d(x[i],x[j])/b)^2)+tao_2_2*(x[i]==x[j])
}
}
return(Sigma)
}
get_f_samples <- function(x,b,tao_2_1,tao_2_2,d_func){
m_x <- rep(0,length(x))
Sigma <- matern_cov(tao_2_1,tao_2_2,b,d_euclid,x)
n_samples <- 10
mat_f <- matrix(NA,nrow= n,ncol=n_samples)
for(i in 1:n_samples){
mat_f[,i] <- rmvnorm(1,mean=m_x,sigma=Sigma)
}
return(mat_f)
}
n <-100
x <- runif(n,0,1)
tao_2_2 <- 1e-06
idx_x <- order(x)
library(dplyr)
j_brew_colors <- brewer.pal(n = n_samples, name = "Dark2")
library(gapminder)
install.packages("gapminder")
install.packages("RColorBrewer")
library(RColorBrewer)
j_brew_colors <- brewer.pal(n = n_samples, name = "Dark2")
library(mvtnorm)
d_euclid <- function(x,x_p){
return(abs(x-x_p))
}
matern_cov <- function(tao_2_1,tao_2_2,b,d,x){
Sigma <- matrix(NA,length(x),length(x))
for(i in 1:length(x)){
for(j in 1:length(x)){
Sigma[i,j] <- tao_2_1*exp(-(1/2)*(d(x[i],x[j])/b)^2)+tao_2_2*(x[i]==x[j])
}
}
return(Sigma)
}
get_f_samples <- function(x,b,tao_2_1,tao_2_2,d_func){
m_x <- rep(0,length(x))
Sigma <- matern_cov(tao_2_1,tao_2_2,b,d_euclid,x)
n_samples <- 10
mat_f <- matrix(NA,nrow= n,ncol=n_samples)
for(i in 1:n_samples){
mat_f[,i] <- rmvnorm(1,mean=m_x,sigma=Sigma)
}
return(mat_f)
}
n <-100
x <- runif(n,0,1)
tao_2_2 <- 1e-06
idx_x <- order(x)
library(RColorBrewer)
j_brew_colors <- brewer.pal(n = n_samples, name = "Dark2")
get_f_samples <- function(x,b,tao_2_1,tao_2_2,d_func,n_samples){
m_x <- rep(0,length(x))
Sigma <- matern_cov(tao_2_1,tao_2_2,b,d_euclid,x)
mat_f <- matrix(NA,nrow= n,ncol=n_samples)
for(i in 1:n_samples){
mat_f[,i] <- rmvnorm(1,mean=m_x,sigma=Sigma)
}
return(mat_f)
}
n_samples <- 10
n <-100
x <- runif(n,0,1)
tao_2_2 <- 1e-06
idx_x <- order(x)
library(RColorBrewer)
j_brew_colors <- brewer.pal(n = n_samples, name = "Dark2")
high_b_high_t1 <- get_f_samples(x,b=1,2,tao_2_2,d_euclid,n_samples)
plot(1, type="n", xlab="", ylab="", xlim=c(0, 1), ylim=c(-5,5))
for(i in 1:n_samples){
lines(x[idx_x],high_b_high_t1[,i][idx_x],col=j_brew_colors[i],lwd=1.5)
}
high_b_high_t1 <- get_f_samples(x,b=1,2,tao_2_2,d_euclid,n_samples)
plot(1, type="n", xlab="", ylab="", xlim=c(0, 1), ylim=c(-5,5))
for(i in 1:n_samples){
lines(x[idx_x],high_b_high_t1[,i][idx_x],col=i,lwd=1.5)
}
high_b_low_t1 <- get_f_samples(x,b=1,0.1,tao_2_2,d_euclid,n_samples)
plot(1, type="n", xlab="", ylab="", xlim=c(0, 1), ylim=c(-5,5))
for(i in 1:n_samples){
lines(x[idx_x],high_b_low_t1[,i][idx_x],col=i,lwd=1.5)
}
low_b_low_t1 <- get_f_samples(x,b=0.01,0.1,tao_2_2,d_euclid,n_samples)
plot(1, type="n", xlab="", ylab="", xlim=c(0, 1), ylim=c(-5,5))
for(i in 1:n_samples){
lines(x[idx_x],low_b_low_t1[,i][idx_x],col=i,lwd=1.5)
}
low_b_low_t1 <- get_f_samples(x,b=0.01,0.1,tao_2_2,d_euclid,n_samples)
plot(1, type="n", xlab="", ylab="", xlim=c(0, 1), ylim=c(-5,5))
for(i in 1:n_samples){
lines(x[idx_x],low_b_low_t1[,i][idx_x],col=i,lwd=1.5)
}
low_b_high_t1 <- get_f_samples(x,b=0.01,2,tao_2_2,d_euclid,n_samples)
plot(1, type="n", xlab="", ylab="", xlim=c(0, 1), ylim=c(-5,5))
for(i in 1:n_samples){
lines(x[idx_x],low_b_high_t1[,i][idx_x],col=i,lwd=1.5)
}
high_b_high_t1 <- get_f_samples(x,b=1,2,0,d_euclid,n_samples)
plot(1, type="n", xlab="", ylab="", xlim=c(0, 1), ylim=c(-5,5))
for(i in 1:n_samples){
lines(x[idx_x],high_b_high_t1[,i][idx_x],col=i,lwd=1.5)
}
high_b_high_t1 <- get_f_samples(x,b=1,2,tao_2_2,d_euclid,n_samples)
plot(1, type="n", xlab="", ylab="", xlim=c(0, 1), ylim=c(-5,5))
for(i in 1:n_samples){
lines(x[idx_x],high_b_high_t1[,i][idx_x],col=i,lwd=1.5)
}
get_f_samples <- function(x,b,tao_2_1,tao_2_2,d_func,cov_func,n_samples){
m_x <- rep(0,length(x))
Sigma <- matern_cov(tao_2_1,tao_2_2,b,d_euclid,x)
mat_f <- matrix(NA,nrow= n,ncol=n_samples)
for(i in 1:n_samples){
mat_f[,i] <- rmvnorm(1,mean=m_x,sigma=Sigma)
}
return(mat_f)
}
high_b_high_t1 <- get_f_samples(x,b=1,2,tao_2_2,d_euclid,matern_cov,n_samples)
plot(1, type="n", xlab="", ylab="", xlim=c(0, 1), ylim=c(-5,5))
for(i in 1:n_samples){
lines(x[idx_x],high_b_high_t1[,i][idx_x],col=i,lwd=1.5)
}
low_b_high_t1 <- get_f_samples(x,b=0.01,2,0,d_euclid,matern_cov,n_samples)
plot(1, type="n", xlab="", ylab="", xlim=c(0, 1), ylim=c(-5,5))
for(i in 1:n_samples){
lines(x[idx_x],low_b_high_t1[,i][idx_x],col=i,lwd=1.5)
}
se_cov <- function(tao_2_1,tao_2_2,b,d,x){
Sigma <- matrix(NA,length(x),length(x))
for(i in 1:length(x)){
for(j in 1:length(x)){
Sigma[i,j] <- tao_2_1*exp(-(1/2)*(d(x[i],x[j])/b)^2)+tao_2_2*(x[i]==x[j])
}
}
return(Sigma)
}
se_cov <- function(tao_2_1,tao_2_2,b,d_func,x){
Sigma <- matrix(NA,length(x),length(x))
for(i in 1:length(x)){
for(j in 1:length(x)){
Sigma[i,j] <- tao_2_1*exp(-(1/2)*(d(x[i],x[j])/b)^2)+tao_2_2*(x[i]==x[j])
}
}
return(Sigma)
}
get_f_samples <- function(x,b,tao_2_1,tao_2_2,d_func,cov_func,n_samples){
m_x <- rep(0,length(x))
Sigma <- matern_cov(tao_2_1,tao_2_2,b,d_euclid,x)
mat_f <- matrix(NA,nrow= n,ncol=n_samples)
for(i in 1:n_samples){
mat_f[,i] <- rmvnorm(1,mean=m_x,sigma=Sigma)
}
return(mat_f)
}
high_b_high_t1 <- get_f_samples(x,b=1,2,tao_2_2,d_euclid,se_cov,n_samples)
plot(1, type="n", xlab="", ylab="", xlim=c(0, 1), ylim=c(-5,5))
for(i in 1:n_samples){
lines(x[idx_x],high_b_high_t1[,i][idx_x],col=i,lwd=1.5)
}
matern_52_cov <-  function(tao_2_1,tao_2_2,b,d_func,x){
Sigma <- matrix(NA,length(x),length(x))
for(i in 1:length(x)){
for(j in 1:length(x)){
d <- d_func(x[i],x[j])
Sigma[i,j] <- tao_2_1*(1+sqrt(5)*(d/b)+(5/3)*(d/b)^2)*exp(-sqrt(5)*(d/b))+ tao_2_2*(x[i]==x[j])
}
}
return(Sigma)
}
high_b_high_t1 <- get_f_samples(x,b=1,2,tao_2_2,d_euclid,matern_52_cov,n_samples)
plot(1, type="n", xlab="", ylab="", xlim=c(0, 1), ylim=c(-5,5))
for(i in 1:n_samples){
lines(x[idx_x],high_b_high_t1[,i][idx_x],col=i,lwd=1.5)
}
low_b_low_t1 <- get_f_samples(x,b=0.01,0.1,tao_2_2,d_euclid,matern_52_cov,n_samples)
plot(1, type="n", xlab="", ylab="", xlim=c(0, 1), ylim=c(-5,5))
for(i in 1:n_samples){
lines(x[idx_x],low_b_low_t1[,i][idx_x],col=i,lwd=1.5)
}
high_b_low_t1 <- get_f_samples(x,b=1,0.1,tao_2_2,d_euclid,matern_52_cov,n_samples)
plot(1, type="n", xlab="", ylab="", xlim=c(0, 1), ylim=c(-5,5))
for(i in 1:n_samples){
lines(x[idx_x],high_b_low_t1[,i][idx_x],col=i,lwd=1.5)
}
low_b_high_t1 <- get_f_samples(x,b=0.01,2,tao_2_2,d_euclid,matern_52_cov,n_samples)
plot(1, type="n", xlab="", ylab="", xlim=c(0, 1), ylim=c(-5,5))
for(i in 1:n_samples){
lines(x[idx_x],low_b_high_t1[,i][idx_x],col=i,lwd=1.5)
}
matern_52_cov <-  function(tao_2_1,tao_2_2,b,d_func,x){
Sigma <- matrix(NA,length(x),length(x))
for(i in 1:length(x)){
for(j in 1:length(x)){
d <- d_func(x[i],x[j])
Sigma[i,j] <- tao_2_1*(1+sqrt(5)*(d/b)+(5/3)*(d/b)^2)*exp(-sqrt(5)*(d/b))+ tao_2_2*(x[i]==x[j])
}
}
return(Sigma)
}
high_b_high_t1 <- get_f_samples(x,b=1,2,tao_2_2,d_euclid,matern_52_cov,n_samples)
plot(1, type="n", xlab="", ylab="", xlim=c(0, 1), ylim=c(-5,5))
for(i in 1:n_samples){
lines(x[idx_x],high_b_high_t1[,i][idx_x],col=i,lwd=1.5)
}
low_b_low_t1 <- get_f_samples(x,b=0.01,0.1,tao_2_2,d_euclid,matern_52_cov,n_samples)
plot(1, type="n", xlab="", ylab="", xlim=c(0, 1), ylim=c(-5,5))
for(i in 1:n_samples){
lines(x[idx_x],low_b_low_t1[,i][idx_x],col=i,lwd=1.5)
}
high_b_low_t1 <- get_f_samples(x,b=1,0.1,tao_2_2,d_euclid,matern_52_cov,n_samples)
plot(1, type="n", xlab="", ylab="", xlim=c(0, 1), ylim=c(-5,5))
for(i in 1:n_samples){
lines(x[idx_x],high_b_low_t1[,i][idx_x],col=i,lwd=1.5)
}
low_b_high_t1 <- get_f_samples(x,b=0.01,2,tao_2_2,d_euclid,matern_52_cov,n_samples)
plot(1, type="n", xlab="", ylab="", xlim=c(0, 1), ylim=c(-5,5))
for(i in 1:n_samples){
lines(x[idx_x],low_b_high_t1[,i][idx_x],col=i,lwd=1.5)
}
library(mvtnorm)
d_euclid <- function(x,x_p){
return(abs(x-x_p))
}
se_cov <- function(tao_2_1,tao_2_2,b,d_func,x){
Sigma <- matrix(NA,length(x),length(x))
for(i in 1:length(x)){
for(j in 1:length(x)){
Sigma[i,j] <- tao_2_1*exp(-(1/2)*(d(x[i],x[j])/b)^2)+tao_2_2*(x[i]==x[j])
}
}
return(Sigma)
}
get_f_samples <- function(x,b,tao_2_1,tao_2_2,d_func,cov_func,n_samples){
m_x <- rep(0,length(x))
Sigma <- cov_func(tao_2_1,tao_2_2,b,d_euclid,x)
mat_f <- matrix(NA,nrow= n,ncol=n_samples)
for(i in 1:n_samples){
mat_f[,i] <- rmvnorm(1,mean=m_x,sigma=Sigma)
}
return(mat_f)
}
n_samples <- 10
n <-100
x <- runif(n,0,1)
tao_2_2 <- 1e-06
idx_x <- order(x)
high_b_high_t1 <- get_f_samples(x,b=1,2,tao_2_2,d_euclid,se_cov,n_samples)
library(mvtnorm)
d_euclid <- function(x,x_p){
return(abs(x-x_p))
}
se_cov <- function(tao_2_1,tao_2_2,b,d_func,x){
Sigma <- matrix(NA,length(x),length(x))
for(i in 1:length(x)){
for(j in 1:length(x)){
Sigma[i,j] <- tao_2_1*exp(-(1/2)*(d_func(x[i],x[j])/b)^2)+tao_2_2*(x[i]==x[j])
}
}
return(Sigma)
}
get_f_samples <- function(x,b,tao_2_1,tao_2_2,d_func,cov_func,n_samples){
m_x <- rep(0,length(x))
Sigma <- cov_func(tao_2_1,tao_2_2,b,d_euclid,x)
mat_f <- matrix(NA,nrow= n,ncol=n_samples)
for(i in 1:n_samples){
mat_f[,i] <- rmvnorm(1,mean=m_x,sigma=Sigma)
}
return(mat_f)
}
n_samples <- 10
n <-100
x <- runif(n,0,1)
tao_2_2 <- 1e-06
idx_x <- order(x)
high_b_high_t1 <- get_f_samples(x,b=1,2,tao_2_2,d_euclid,se_cov,n_samples)
plot(1, type="n", xlab="", ylab="", xlim=c(0, 1), ylim=c(-5,5))
for(i in 1:n_samples){
lines(x[idx_x],high_b_high_t1[,i][idx_x],col=i,lwd=1.5)
}
low_b_low_t1 <- get_f_samples(x,b=0.01,0.1,tao_2_2,d_euclid,se_cov,n_samples)
plot(1, type="n", xlab="", ylab="", xlim=c(0, 1), ylim=c(-5,5))
for(i in 1:n_samples){
lines(x[idx_x],low_b_low_t1[,i][idx_x],col=i,lwd=1.5)
}
high_b_low_t1 <- get_f_samples(x,b=1,0.1,tao_2_2,d_euclid,se_cov,n_samples)
plot(1, type="n", xlab="", ylab="", xlim=c(0, 1), ylim=c(-5,5))
for(i in 1:n_samples){
lines(x[idx_x],high_b_low_t1[,i][idx_x],col=i,lwd=1.5)
}
low_b_high_t1 <- get_f_samples(x,b=0.01,2,tao_2_2,d_euclid,se_cov,n_samples)
plot(1, type="n", xlab="", ylab="", xlim=c(0, 1), ylim=c(-5,5))
for(i in 1:n_samples){
lines(x[idx_x],low_b_high_t1[,i][idx_x],col=i,lwd=1.5)
}
matern_52_cov <-  function(tao_2_1,tao_2_2,b,d_func,x){
Sigma <- matrix(NA,length(x),length(x))
for(i in 1:length(x)){
for(j in 1:length(x)){
d <- d_func(x[i],x[j])
Sigma[i,j] <- tao_2_1*(1+sqrt(5)*(d/b)+(5/3)*(d/b)^2)*exp(-sqrt(5)*(d/b))+ tao_2_2*(x[i]==x[j])
}
}
return(Sigma)
}
high_b_high_t1 <- get_f_samples(x,b=1,2,tao_2_2,d_euclid,matern_52_cov,n_samples)
plot(1, type="n", xlab="", ylab="", xlim=c(0, 1), ylim=c(-5,5))
for(i in 1:n_samples){
lines(x[idx_x],high_b_high_t1[,i][idx_x],col=i,lwd=1.5)
}
low_b_low_t1 <- get_f_samples(x,b=0.01,0.1,tao_2_2,d_euclid,matern_52_cov,n_samples)
plot(1, type="n", xlab="", ylab="", xlim=c(0, 1), ylim=c(-5,5))
for(i in 1:n_samples){
lines(x[idx_x],low_b_low_t1[,i][idx_x],col=i,lwd=1.5)
}
high_b_low_t1 <- get_f_samples(x,b=1,0.1,tao_2_2,d_euclid,matern_52_cov,n_samples)
plot(1, type="n", xlab="", ylab="", xlim=c(0, 1), ylim=c(-5,5))
for(i in 1:n_samples){
lines(x[idx_x],high_b_low_t1[,i][idx_x],col=i,lwd=1.5)
}
low_b_high_t1 <- get_f_samples(x,b=0.01,2,tao_2_2,d_euclid,matern_52_cov,n_samples)
plot(1, type="n", xlab="", ylab="", xlim=c(0, 1), ylim=c(-5,5))
for(i in 1:n_samples){
lines(x[idx_x],low_b_high_t1[,i][idx_x],col=i,lwd=1.5)
}
